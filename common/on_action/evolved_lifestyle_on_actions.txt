three_year_playable_pulse = {    
    on_actions = {
        evolve_hunter_trait
    }
}

five_year_everyone_pulse = {
    on_actions = {
        fix_potential_trait_characters
    }
}

evolve_hunter_trait = {
	trigger = {
		# is_ai = no
		culture = {
			has_cultural_parameter = warg_trait_unlocked
		}

		is_spark_talented = yes

		has_trait = lifestyle_hunter
		OR = {
			has_trait_xp = {
				trait = lifestyle_hunter
				track = hunter
				value >= 100
			}
			has_trait_xp = {
				trait = lifestyle_hunter
				track = falconer
				value >= 100
			}
		}

		has_pet = yes

		NOT = {
			has_trait = warg
		}
	}

	effect = {
		trigger_event = warg.001
	}
}

fix_potential_trait_characters = {
    trigger = {
        OR = {
            AND = {
                has_trait = heroic
                NOT = {
                    culture = {
                        has_cultural_parameter = heroic_trait_unlocked
                    }
                    enemies_slayed > 4
                }
            }
            AND = {
                has_trait = heroic_valar
                is_valar = no
            }
            AND = {
                has_trait = passionate
                NOT = {
                    culture = {
                        has_cultural_parameter = passionate_trait_unlocked
                    }
                    times_had_sex_with_a_lord_count >= 2
                }
            }
            AND = {
                has_trait = passionate_valar
                is_valar = no
            }
            AND = {
                has_trait = intellect_good_4
                NOT = {
					OR = {
						any_parent = {
							OR = {
								has_trait = intellect_good_3
								has_trait = intellect_good_4
							}
							culture = {
								has_cultural_parameter = higher_level_base_genetics_unlocked
							}
						}
						culture = {
							has_cultural_parameter = higher_level_base_genetics_unlocked
						}
						is_valar = yes
					}
				}
            }
            AND = {
                has_trait = beauty_good_4
                NOT = {
					OR = {
						any_parent = {
							OR = {
								has_trait = beauty_good_3
								has_trait = beauty_good_4
							}
							culture = {
								has_cultural_parameter = higher_level_base_genetics_unlocked
							}
						}
						culture = {
							has_cultural_parameter = higher_level_base_genetics_unlocked
						}
						is_valar = yes
					}
				}
            }
            AND = {
                has_trait = physique_good_4
                NOT = {
					OR = {
						any_parent = {
							OR = {
								has_trait = physique_good_3
								has_trait = physique_good_4
							}
							culture = {
								has_cultural_parameter = higher_level_base_genetics_unlocked
							}
						}
						culture = {
							has_cultural_parameter = higher_level_base_genetics_unlocked
						}
						is_valar = yes
					}
				}
            }
        }
    }

    effect = {
		debug_log = "fix_potential_trait_characters!"
		debug_log_scopes = yes
        fix_starter_character_traits_effect = yes
    }
}